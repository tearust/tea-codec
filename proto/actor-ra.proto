syntax = "proto2";

package actor_ra;

message LibP2PInitInfo {
  required bytes encodedBytes = 1;
  required bytes tpmSignature = 2;//sign based on public key of keypair not the encoded bytes
  required bytes teaId = 3;
  required uint32 blockHeightAtSign = 4;
  required bytes blockHashAtSign = 5;

}

message VerifyIdRequest{
  required uint32 nonce = 1;
  required bytes tpmSignature = 2;//sign based on public key of keypair not the encoded bytes
  required bytes teaId = 3;
  required uint32 blockHeightAtSign = 4;
  required bytes blockHashAtSign = 5;
  required bytes publicKey = 7;
  required string replyTo = 6;
}

message VerifyIdResponse{
  required uint32 nonce = 1;
  required bytes publicKey = 2;
  required bool result = 3;
  required uint32 blockHeightAtSign = 4;
  required uint32 blockHeightAtVerify = 6;
  optional string error = 5;
}

message PutPeerUrlResponse{
  repeated string list = 1;
}

message TeaNodeProfile{
  required uint32 profileVersion = 1;
  required bytes body = 2;
}

message TeaNodeProfileV1{
  repeated bytes pcrValues = 1;
}

message TeaNodeUpdateProfileRequest{
  required bytes ephemeralPublicKey = 1;//Generated by TPM everytime when tea node starts. It is expired when shutdown.
  repeated string publicUrls = 2;//Public URLs if this node is a bootstrap node. If would be [] if this node does not provide public service
  required string profileCid = 3;//IPFS Cid to store profile object->TeaNodeProfile
  required bytes teaId = 4;//The node's TPM ID which generates ephemeralPublicKey and sign 
  required bytes signature = 5;//sign message is ephermeralPublicKey , signed using teaId.
}